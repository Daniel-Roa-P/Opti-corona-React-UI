import csv
import os

referencias = ['246021151','246021181','246021451','246021491','246031061','246031151','247031151','247031761','247041101','256991001','256991041','256991051','256991061','256991461','256991481','265021001','265041061','266101791','266121151','266121251','266121451','266131791','267011751','267021501','305591001','309271151','309281791','309291051','309291501','425111761','425111791','425131761','425131791','435749001','451249001','452871791','452889501','452889761','452899001','452899501','453701151','453711761','453721031','453721501','453739511','453741791','453751791','453761601','453771791','453781791','453791791','453801791','453889001','458241031','458451501','458451791','601672031','601672501','602932031','603181791','603191791','603201791','603211791','603221791','603232501','603242031','603242501','603262031','603292501','603312501','603322791','603332001','603332501','608421791','608472761','608482031','608492791','609799511','609809001','609819001','609819501','611022001','611022601','617022001','617022051','617022501','617032001','617032051','617032501','617042031','617042511','617042551','617042771','617052031','617052501','617062501','617072501','617102031','617112031','617142031','617142501','617162031','617172501','617212501','903072031','903072501','903072541','903072761','903082501','903102711','903102761','907352761','907362051','907362501','907372051','907372761','923022031','923022501','923032531','923032771','923042751','923052791','923062501','925022001','927022601','927032031','927042051','927052051','927052501']

dir_path = str(os.getcwd()) + '/documents'

# list file and directories
res = os.listdir(dir_path)
text_file = open("technical_documents-co-es.csv", "w")
# DON'T FORGET IMPEX FILE GENERATION 

impex_file = open("technical_documents_bim_rfa.sql", "w")
impex_file.write('''$productCatalog = corona-coProductCatalog
$catalogVersion = catalogversion(catalog(id[default=$productCatalog]), version[default='Staged'])[unique=true, default=$productCatalog:Staged]

$lang = es
UPDATE GenericDocument; $catalogVersion; code[unique = true]; documentType(code); mime[default = 'application/CDFV2-unknown']
''')


todo = ''
ultimo = ''

for referencia in referencias:
    
    for filename in res:
            
        if (referencia in filename):
            
            text_file.write(referencia + ',' + filename + ',Modelo BIM')
            text_file.write('\n')
            impex_file.write(';;'+filename+';;')
            impex_file.write('\n')
        
impex_file.close()
text_file.close()